<app-card>
  <div class="flex flex-col p-4 border-b border-b-gray-200" card-header>
    <div class="flex items-center justify-between">
      <h2 class="text-lg font-semibold">Ventas CFE</h2>
      <div class="flex gap-1">
        <p-floatlabel variant="on">
          <input
            pInputText
            id="on_tienda"
            [(ngModel)]="findTienda"
            autocomplete="off"
            type="text"
            pSize="small"
            (ngModelChange)="updateFiltros({ tienda: $event })"
          />
          <label for="on_tienda">Tienda</label>
        </p-floatlabel>
        <p-floatlabel variant="on">
          <p-datepicker
            [(ngModel)]="rangeDates"
            selectionMode="range"
            [showButtonBar]="true"
            inputId="on_range"
            showIcon
            iconDisplay="input"
            size="small"
            dateFormat="dd/mm/yy"
            (ngModelChange)="changeFecha($event)"
          />
          <label for="on_range">Desde - Hasta</label>
        </p-floatlabel>
        <p-button size="small" (onClick)="getVentas()">
          <ng-template pTemplate="icon">
            <i class="material-symbols-outlined !text-[20px]">search</i>
          </ng-template>
        </p-button>
        <p-button
          label="Exportar"
          size="small"
          severity="success"
          (onClick)="exportExcel()"
        >
          <ng-template pTemplate="icon">
            <i class="material-symbols-outlined !text-[20px]">file_export</i>
          </ng-template>
        </p-button>
      </div>
    </div>
    <!-- @if (showPanel) {
      <div class="flex gap-2 transition-all duration-500 ease-in-out mt-2">
        <p-floatlabel variant="on">
          <p-datepicker
            [(ngModel)]="date2"
            inputId="lbl_desde"
            showIcon
            iconDisplay="input"
            size="small"
          />
          <label for="lbl_desde">Desde</label>
        </p-floatlabel>
        <p-floatlabel variant="on">
          <p-datepicker
            [(ngModel)]="date2"
            inputId="lbl_hasta"
            showIcon
            iconDisplay="input"
            size="small"
          />
          <label for="lbl_hasta">Hasta</label>
        </p-floatlabel>
      </div>
    } -->
  </div>
  <div card-content>
    <!-- <ng-scrollbar class="rounded-b-lg overflow-hidden h-[calc(100vh-157px)]"> -->
    <div class="rounded-b-lg overflow-hidden">
      <p-table
        [value]="listVentas()"
        stripedRows="true"
        [scrollable]="true"
        scrollHeight="calc(100vh - 150px)"
        emptyMessage="No se encontraron registros."
      >
        <ng-template #header>
          <tr class="text-md">
            <th pSortableColumn="tienda" style="width: 20%">
              <div class="flex justify-between items-center gap-2">
                Tienda
                <p-sortIcon field="tienda"></p-sortIcon>
                <p-column-filter
                  type="text"
                  field="tienda"
                  display="menu"
                  class="ml-auto"
                />
              </div>
            </th>
            <th pSortableColumn="fecha" style="width: 20%">
              <div class="flex justify-between items-center gap-2">
                Fecha
                <p-sortIcon field="fecha"></p-sortIcon>
              </div>
            </th>
            <th pSortableColumn="venta" style="width: 20%">
              <div class="flex justify-between items-center gap-2">
                Venta
                <p-sortIcon field="venta"></p-sortIcon>
              </div>
            </th>
          </tr>
        </ng-template>
        <ng-template #body let-venta>
          <tr class="text-xs">
            <td class="!py-2">{{ venta.tienda }}</td>
            <td class="!py-2">{{ venta.fecha | date: "dd/MM/yyyy" }}</td>
            <td class="!py-2">{{ venta.venta | currency }}</td>
          </tr>
        </ng-template>
        <ng-template #footer>
          <tr class="text-sm font-bold">
            <td colspan="2">Totales</td>
            <td>
              {{ ventaTotal() | currency }}
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</app-card>
<p-toast />
